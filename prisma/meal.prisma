model Meal {
  id          String  @id @default(uuid())
  name        String
  description String  @db.Text
  price       Decimal @db.Decimal(10, 2)
  image       String
  isAvailable Boolean @default(true)

  categoryId String
  category   Category @relation(fields: [categoryId], references: [id])

  providerId String
  provider   ProviderProfile @relation(fields: [providerId], references: [id], onDelete: Cascade)

  orderItems OrderItem[]
  reviews    Review[]
  cartItems  CartItem[]

  @@map("meals")
}

model ProviderProfile {
  id             String  @id @default(uuid())
  bio            String? @db.Text
  address        String
  phoneNumber    String
  bannerImage    String?
  restaurantName String @default("Unnamed Restaurant")

  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  meals  Meal[]
  orders Order[]

  @@index([restaurantName])
  @@map("provider_profiles")
}

model Order {
  id          String      @id @default(uuid())
  status      OrderStatus @default(PENDING)
  totalAmount Decimal     @db.Decimal(10, 2)
  address     String
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  userId String
  user   User   @relation(fields: [userId], references: [id])

  providerId String
  provider   ProviderProfile @relation(fields: [providerId], references: [id])

  items OrderItem[]

  @@map("orders")
}

enum OrderStatus {
  PENDING
  PREPARING
  READY
  DELIVERED
  CANCELLED
}

model OrderItem {
  id       String  @id @default(uuid())
  quantity Int
  price    Decimal @db.Decimal(10, 2)

  orderId String
  order   Order  @relation(fields: [orderId], references: [id], onDelete: Cascade)
  mealId  String
  meal    Meal   @relation(fields: [mealId], references: [id])

  @@unique([orderId, mealId])
  @@map("order_items")
}

model Category {
  id    String  @id @default(uuid())
  name  String  @unique
  image String? // For the Bento Grid icons
  meals Meal[]

  @@map("categories")
}
